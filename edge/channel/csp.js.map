{"version":3,"sources":["channel/csp.js"],"names":["$csp","csp","require","node","channel","opts","id","name","val","soul","data","op","log","args","defaultPutCb","event","putCb","eventListener","putAsync"],"mappings":";;;;;QAOgBA,I,GAAAA,I;;AAPhB;;;;;;AACA;AACA,IAAMC,MAAMC,QAAQ,QAAR,CAAZ;;AAEA;;AAEA;AACO,SAASF,IAAT,CAAcG,IAAd,EAAoBC,OAApB,EAAwC;AAAA,MAAXC,IAAW,uEAAJ,EAAI;;AAC7C,MAAIC,WAAJ;AAAA,MAAQC,aAAR;AACAJ,OAAKK,GAAL,CAAS,gBAAQ;AACfF,SAAK,cAAIH,IAAJ,CAASM,IAAT,CAAcC,IAAd,CAAL;AACAH,WAAOF,KAAKE,IAAL,IAAaD,EAAb,IAAmB,SAA1B;AACD,GAHD;AAIA,MAAMK,KAAKN,KAAKM,EAAL,IAAW,IAAtB;AACA,MAAMC,MAAM,SAANA,GAAM,GAAmB;AAC7B,QAAIP,KAAKO,GAAT,EAAc;AAAA;;AAAA,wCADSC,IACT;AADSA,YACT;AAAA;;AACZ,2BAAQD,GAAR,kBAAY,KAAZ,EAAmBL,IAAnB,SAA4BM,IAA5B;AACD;AACF,GAJD;;AAMA,MAAIC,eAAe,SAAfA,YAAe,CAACC,KAAD,EAAW;AAC5BH,QAAI,6BAAJ;AACD,GAFD;AAGA,MAAII,QAAQX,KAAKW,KAAL,IAAcF,YAA1B;;AAEA,MAAIG,gBAAgB,SAAhBA,aAAgB,CAAUF,KAAV,EAAiB;AACnCH,QAAI,aAAJ,EAAmBG,KAAnB;AACAd,QAAIiB,QAAJ,CAAad,OAAb,EAAsBW,KAAtB,EAA6BC,KAA7B;AACA;AACD,GAJD;;AAMAb,OAAKQ,EAAL,EAASM,aAAT;AACD","file":"csp.js","sourcesContent":["import Gun from 'gun/gun';\n// import csp from 'js-csp'\nconst csp = require('js-csp')\n\n// See https://github.com/ubolonton/js-csp/blob/master/doc/basic.md\n\n// See https://github.com/staltz/xstream\nexport function $csp(node, channel, opts = {}) {\n  let id, name\n  node.val(data => {\n    id = Gun.node.soul(data)\n    name = opts.name || id || 'unknown'\n  })\n  const op = opts.op || 'on'\n  const log = function (...args) {\n    if (opts.log) {\n      console.log('rx:', name, ...args)\n    }\n  }\n\n  let defaultPutCb = (event) => {\n    log('event was put on channel :)')\n  }\n  let putCb = opts.putCb || defaultPutCb\n\n  let eventListener = function (event) {\n    log('Channel PUT', event)\n    csp.putAsync(channel, event, putCb)\n    // csp.put(channel, event)\n  }\n\n  node[op](eventListener);\n}"]}